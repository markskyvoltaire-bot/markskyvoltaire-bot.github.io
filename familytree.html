<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Voltaire Family Tree</title>
<link rel="stylesheet" href="https://balkan.app/js/familytree.css">
<script src="https://balkan.app/js/familytree.js"></script>
<style>
    body, html {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        background-color: #fdf3d9;
    }
    #tree {
        width: 100%;
        height: 100%;
    }
</style>
</head>
<body>
<div id="tree"></div>

<script>
const data = [
    { id: "@I1@", name: "Mark Voltaire", sex: "M", parents: ["@I2@", "@I3@"] },
    { id: "@I2@", name: "Karl Voltaire", sex: "M", parents: ["@I7@", "@I8@"] },
    { id: "@I3@", name: "Claire Abgrall", sex: "F", parents: ["@I5@", "@I6@"] },
    { id: "@I4@", name: "Mikael Voltaire", sex: "M", parents: ["@I2@", "@I3@"] },
    { id: "@I5@", name: "Jean Abgrall", sex: "M" },
    { id: "@I6@", name: "Monique Drouaire", sex: "F" },
    { id: "@I7@", name: "Michel-Ange Voltaire", sex: "M" },
    { id: "@I8@", name: "Adrienne Anglade", sex: "F" }
];

// Prepare nodes and marriages
const nodes = [];
const marriages = [];
const personMap = {};

// Map persons
data.forEach(p => {
    personMap[p.id] = {
        id: p.id,
        name: p.name,
        gender: p.sex === "M" ? "male" : "female"
    };
});

// Create nodes and marriages
data.forEach(p => {
    if (p.parents && p.parents.length === 2) {
        const marriageId = `${p.parents[0]}_${p.parents[1]}_marriage`;
        let marriage = marriages.find(m => m.id === marriageId);
        if (!marriage) {
            marriages.push({
                id: marriageId,
                spouses: p.parents,
                children: [p.id]
            });
        } else {
            marriage.children.push(p.id);
        }
    } else if (p.parents && p.parents.length === 1) {
        nodes.push({
            id: p.id,
            name: p.name,
            gender: p.sex === "M" ? "male" : "female",
            pid: p.parents[0]
        });
    } else {
        nodes.push({
            id: p.id,
            name: p.name,
            gender: p.sex === "M" ? "male" : "female"
        });
    }
});

// Initialize chart
new FamilyTree(document.getElementById('tree'), {
    nodes: nodes,
    marriages: marriages,
    template: "hugo",
    enableSearch: true,
    mouseScroll: FamilyTree.scroll.scroll
});

console.log("Family tree loaded successfully");
</script>
</body>
</html>
